TMP=tmp
OUT=out
MYTAR=mytar.mtar
FILE1=file1.txt
FILE2=file2.txt
FILE3=file3.dat

if [ ! -e ./mytar ]; then
    echo "Mytar no encontrado"
    exit -1

elif [ ! -x ./mytar ]; then
	echo "Mytar no es ejecutable"
    exit -1
fi

if [ -d "$TMP" ]; then
	rm -rf -- $TMP #borramos el directorio tmp si lo encontramos
fi

mkdir $TMP #creamos nuevo directorio tmp
cd $TMP	 #nos metemos dentro de el

if [ ! -e $FILE1 ]; then
	touch $FILE1 
	echo "Hello World!" > $FILE1 #escribimos Hello World! y se lo metemos al file
fi
if [ ! -e $FILE2 ]; then
	touch $FILE2 
	head -10 /etc/passwd > $FILE2 #copiamos las 10 primeras lÃ­neas del fichero /etc/passwd.
fi
if [ ! -e $FILE3 ]; then
	touch $FILE3 #ponemos un contenido binario aleatorio de 1024 bytes, tomado del dispositivo/dev/urandom
	head -c 1024 /dev/urandom > $FILE3
fi

./../mytar -c -f $MYTAR $FILE1 $FILE2 $FILE3 #creamos el comprimido con los tres archivos

if [ ! -d $OUT ]; then
	mkdir $OUT #creamos out en tmp
fi

cp ./$MYTAR ./$OUT/$MYTAR # y copiamos el comprimido

cd $OUT
./../../mytar -x -f $MYTAR # extraemos el contenido

if diff ../$FILE1 $FILE1 >/dev/null ; then
	if diff ../$FILE2 $FILE2 >/dev/null ; then
		if diff ../$FILE3 $FILE3 >/dev/null ; then
  			../..
  			echo "Correct"
  			exit 0
  		else
  			../..
  			echo "Uno o mas archivos son diferentes"
			exit 1
		fi
	else
  			../..
  			echo "Uno o mas archivos son diferentes"
			exit 1
	fi	

else
	../..
  	echo "Uno o mas archivos son diferentes"
	exit 1
fi
